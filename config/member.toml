# RINA IPCP Configuration - Member Mode
# This IPCP will enroll with the bootstrap IPCP to join the DIF

[ipcp]
name = "ipcp-member-1"
type = "normal"
mode = "member"

[dif]
name = "production-dif"
# Address will be dynamically assigned by bootstrap during enrollment
# Set to 0 or omit to request dynamic assignment
address = 0

[shim]
bind_address = "0.0.0.0"
bind_port = 7001

[enrollment]
# List of bootstrap IPCPs to contact for enrollment
bootstrap_peers = [
    { address = "127.0.0.1:7000", rina_addr = 1001 }
]
# Enrollment timeout in seconds (optimized for local development)
timeout_secs = 5
# Maximum retry attempts
max_retries = 3
# Initial backoff in milliseconds (exponential backoff: 1s, 2s, 4s)
initial_backoff_ms = 1000

[routing]
# Static route to bootstrap (member learns other routes during enrollment)
static_routes = [
    { destination = 1001, next_hop_address = "127.0.0.1:7000", next_hop_rina_addr = 1001 },
]

# Route persistence settings
# NOTE: These settings are IGNORED in member mode!
# Members learn routes dynamically from bootstrap during enrollment and do not
# manage their own routing persistence. Only bootstrap IPCPs should enable this.
# Set enable_route_persistence=false to avoid a startup warning.
enable_route_persistence = false

[rib]
# RIB state persistence for member resilience
# Members can optionally persist their RIB state locally for faster recovery
# after restart (otherwise they'll re-sync from bootstrap)
enable_rib_persistence = false
# Path to RIB snapshot file (binary format)
rib_snapshot_path = "snapshots/rib/ari-member.bin"
# Interval between automatic RIB snapshots in seconds (0 = disabled)
rib_snapshot_interval_seconds = 0
# Maximum number of changes to keep in change log
change_log_size = 1000
# Periodic RIB synchronization from bootstrap (seconds)
# Members periodically request incremental updates from bootstrap
# Set to 0 to disable periodic sync (sync only during enrollment)
rib_sync_interval_secs = 60
